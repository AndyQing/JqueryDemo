<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>不可编辑但合并单元格的Table!</title>

    <link href="https://unpkg.com/jquery-resizable-columns@0.2.3/dist/jquery.resizableColumns.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
        integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.15.4/dist/bootstrap-table.min.css">
</head>

<body>
    <div class="table-box" style="margin: 20px;">
        <div id="toolbar">
            <button id="button" class="btn btn-default">insertRow</button>
            <button id="getTableData" class="btn btn-default">getTableData</button>
        </div>
        <table id="table2" data-show-footer="true"></table>
    </div>
    <table data-toggle="table" data-search="true" data-pagination="true" id="table" data-search="true"
        data-show-refresh="true" data-show-toggle="true" data-show-fullscreen="true" data-show-columns="true"
        data-detail-view="true" data-show-export="true" data-click-to-select="true"
        data-detail-formatter="detailFormatter" data-minimum-count-columns="1" data-show-pagination-switch="true"
        data-id-field="id" data-page-list="[10, 25, 50, 100, all]" data-show-footer="true" data-side-pagination="server"
        data-resizable="true">
        <!-- <thead>
            <tr>
                <th colspan="2">Item Detail</th>
                <th data-field="id2">Item Detail22</th>
                <th data-field="id" rowspan="2" data-valign="middle">Item ID</th>
            </tr>
            <tr>
                <th data-field="name">Item Name</th>
                <th data-field="price">Item Price</th>
                <th data-field="id2">Item Detail22</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Item 1</td>
                <td>222</td>
                <td>$1</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Item 2</td>
                <td>222-2</td>
                <td>$2</td>
            </tr>
        </tbody> -->
        <!-- <thead>
            <tr>
                <th data-field="id">Item ID</th>
                <th data-field="name">Item Name</th>
                <th data-field="price">Item Price</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Item 1</td>
                <td>$1</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Item 2</td>
                <td>$2</td>
            </tr>
        </tbody> -->
    </table>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/jquery-resizable-columns@0.2.3/dist/jquery.resizableColumns.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.15.4/dist/bootstrap-table.min.js"></script>
    <script
        src="https://unpkg.com/bootstrap-table@1.15.4/dist/extensions/resizable/bootstrap-table-resizable.min.js"></script>
    <script>

        $("#table").bootstrapTable({
            // url: 'data2.json',
            columns: [
                [
                    {
                        "title": "洗衣机统计表",
                        "halign": "center",
                        "align": "center",
                        "colspan": 5
                    }
                ],
                [
                    {
                        field: 'name',
                        title: "功能分组",
                        valign: "middle",
                        align: "center",
                        colspan: 1,
                        rowspan: 2
                    },
                    {
                        title: "美的",
                        valign: "middle",
                        align: "center",
                        colspan: 2,
                        rowspan: 1
                    },
                    {
                        title: "松下",
                        valign: "middle",
                        align: "center",
                        colspan: 2,
                        rowspan: 1
                    }
                ],
                [
                    {
                        field: 'mideaNum',
                        title: 'meidi数量',
                        valign: "middle",
                        align: "center"
                    },
                    {
                        field: 'mideaPercent',
                        title: 'meidi占比',
                        valign: "middle",
                        align: "center"
                    },
                    {
                        field: 'panasonicNum',
                        title: 'sx数量',
                        valign: "middle",
                        align: "center"
                    },
                    {
                        field: 'sxPercent',
                        title: 'sx占比',
                        valign: "middle",
                        align: "center",
                        visible: false//隐藏列的第一种方法
                    },
                ]
            ],
            data: [{
                id: 1,
                name: 'Item 1',
                mideaNum: '123',
                mideaPercent: '50%',
                panasonicNum: '666',
                // sxPercent: '20%'
            }, {
                id: 2,
                name: 'Item 2',
                mideaNum: '123',
                mideaPercent: '50%',
                panasonicNum: '666',
                // sxPercent: '40%'
            }]
        });

        //  $("#table").bootstrapTable('hideColumn', 'sxPercent');//隐藏列的第二种方法

        // $('.dropdown-menu label:last-child').remove();
        $('.dropdown-menu label').each(function () {
            if ($(this).children('span').text() === 'sx占比') {
                $(this).remove();
            }
        })

        // $('#table').bootstrapTable({
        //     columns: [ [
        //             {
        //                 "title": "洗衣机统计表",
        //                 "halign":"center",
        //                 "align":"center",
        //                 "colspan": 5
        //             }
        //         ],
        //         [
        //             {
        //                 field: 'name',
        //                 title: "功能分组",
        //                 valign:"middle",
        //                 align:"center",
        //                 colspan: 1,
        //                 rowspan: 2
        //             },
        //             {
        //                 title: "美的",
        //                 valign:"middle",
        //                 align:"center",
        //                 colspan: 2,
        //                 rowspan: 1
        //             },
        //             {
        //                 title: "松下",
        //                 valign:"middle",
        //                 align:"center",
        //                 colspan: 2,
        //                 rowspan: 1
        //             }
        //         ],
        //         [
        //             {
        //                 field: 'mideaNum',
        //                 title: '数量',
        //                 valign:"middle",
        //                 align:"center"
        //             },
        //             {
        //                 field: 'mideaPercent',
        //                 title: '占比',
        //                 valign:"middle",
        //                 align:"center"
        //             },
        //             {
        //                 field: 'panasonicNum',
        //                 title: '数量',
        //                 valign:"middle",
        //                 align:"center"
        //             },
        //             {
        //                 field: 'panasonicPercent',
        //                 title: '占比',
        //                 valign:"middle",
        //                 align:"center"
        //             }
        //         ]
        //     ],
        //     data: [{
        //         id: 1,
        //         name: 'Item 1',
        //         price: '$1'
        //     }, {
        //         id: 2,
        //         name: 'Item 2',
        //         price: '$2'
        //     }]
        // })

    </script>
    <script>
        $(function () {
            let $table = $('#table2');
            let $button = $('#button');
            let $getTableData = $('#getTableData');

            $button.click(function () {
                $table.bootstrapTable('insertRow', {
                    index: 0,
                    row: {
                        id: '',
                        name: '',
                        price: ''
                    }
                });
            });

            $table.bootstrapTable({
                // url: 'data2.json',
                // cache: false,
                // toolbar: '#toolbar',
                clickEdit: true,
                showToggle: true,
                pagination: true,       //显示分页条
                showColumns: true,
                showPaginationSwitch: true,     //显示切换分页按钮
                showRefresh: true,      //显示刷新按钮
                //clickToSelect: true,  //点击row选中radio或CheckBox
                columns: [{
                    checkbox: true
                }, {
                    field: 'id',
                    title: 'Item ID'
                }, {
                    field: 'name',
                    title: 'Item Name'
                }, {
                    field: 'price',
                    title: 'Item Price'
                },],
                data: [{
                    id: 1,
                    name: 'Item 1',
                    price: '$1'
                }, {
                    id: 2,
                    name: 'Item 2',
                    price: '$2'
                }],
                /**
                 * @param {点击列的 field 名称} field
                 * @param {点击列的 value 值} value
                 * @param {点击列的整行数据} row
                 * @param {td 元素} $element
                 */
                onClickCell: function (field, value, row, $element) {
                    $element.attr('contenteditable', true);
                    $element.blur(function () {
                        let index = $element.parent().data('index');
                        let tdValue = $element.html();

                        saveData(index, field, tdValue);
                    })
                }
            });

            $getTableData.click(function () {
                alert(JSON.stringify($table.bootstrapTable('getData')));
            });

            function saveData(index, field, value) {
                $table.bootstrapTable('updateCell', {
                    index: index,       //行索引
                    field: field,       //列名
                    value: value        //cell值
                })
            }

        });
    </script>
</body>

</html>